<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard PROCASEF - Suivi des op√©rations √† Boundou</title>
    <meta name="description" content="Dashboard pour le suivi des op√©rations du projet PROCASEF √† Boundou - Palette Orange Gold et Bleu Navy">
    <link rel="stylesheet" href="css/style.css">
    
    <!-- Chart.js via UMD pour compatibilit√© max (PAS de type="module", PAS d'import/export) -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
    <!-- Leaflet -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <!-- Leaflet Marker Cluster (optionnel / pour la carte) -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet.markercluster@1.4.1/dist/MarkerCluster.css" />
    <script src="https://unpkg.com/leaflet.markercluster@1.4.1/dist/leaflet.markercluster.js"></script>
    
    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>üèõÔ∏è</text></svg>">
</head>
<body>
    <div class="app-container">
        <!-- Sidebar Navigation -->
        <nav class="sidebar" id="sidebar">
            <div class="sidebar-header">
                <div class="logo-section">
                    <div class="logo-icon">üèõÔ∏è</div>
                </div>  
                <button class="sidebar-toggle" id="sidebarToggle" aria-label="Toggle sidebar">
                    <span class="hamburger"></span>
                </button>
                  
            </div>
            
            <div class="nav-menu">
                <a href="#" class="nav-item active" data-section="accueil" aria-label="Accueil">
                    <span class="nav-icon">üè†</span>
                    <span class="nav-text">Accueil</span>
                </a>
                <a href="#" class="nav-item" data-section="parcelles" aria-label="Parcelles">
                    <span class="nav-icon">üß±</span>
                    <span class="nav-text">Parcelles</span>
                </a>
                <a href="#" class="nav-item" data-section="etat-avancement" aria-label="√âtat d'avancement">
                    <span class="nav-icon">üöß</span>
                    <span class="nav-text">√âtat d'avancement</span>
                </a>
                <a href="#" class="nav-item" data-section="projections-2025" aria-label="Projections 2025">
                    <span class="nav-icon">üìÖ</span>
                    <span class="nav-text">Projections 2025</span>
                </a>
                <!--<a href="#" class="nav-item" data-section="genre" aria-label="Genre">
                    <span class="nav-icon">üë•</span>
                    <span class="nav-text">Genre</span>-->
                </a>
                <a href="#" class="nav-item" data-section="rapport" aria-label="Rapport complet">
                    <span class="nav-icon">üë´üèø</span>
                    <span class="nav-text">R√©partition Genre</span>
                </a>
                <a href="#" class="nav-item" data-section="post-traitement" aria-label="Post-traitement">
                    <span class="nav-icon">üõ†Ô∏è</span>
                    <span class="nav-text">Post-traitement</span>
                </a>
            </div>
        </nav>

        <!-- Main Content Area -->
        <main class="main-content">
            <!-- Header -->
            <header class="app-header">
                <div class="header-content">
                    <div class="header-left">
                        <img src="img/BETPLUSAUDETAG.png" alt="Logo BETPLUS AUDETAG" class="header-logo" />
                        <h1 class="page-title" id="pageTitle">Dashboard PROCASEF Boundou</h1>
                    </div>

                    <div class="header-actions">
                        <!-- Font Size Control -->
                        <div class="font-size-control">
                            <button class="font-btn" id="fontDecrease" aria-label="Diminuer la taille de police">A-</button>
                            <div class="font-slider-container">
                                <input type="range" id="fontSizeSlider" min="12" max="20" value="14" step="1" class="font-slider" aria-label="Taille de police">
                                <div class="font-tooltip" id="fontTooltip">14px</div>
                            </div>
                            <button class="font-btn" id="fontIncrease" aria-label="Augmenter la taille de police">A+</button>
                        </div>
                        <div class="status status--success">
                            <span>Derni√®re MAJ: <span id="lastUpdate">19/07/2025</span></span>
                        </div>
                    </div>
                </div>
            </header>

            <!-- Content Sections -->
            <div class="content-area">
                <!-- Loading State -->
                <div id="loading" class="loading-container">
                    <div class="spinner"></div>
                    <p>Chargement des donn√©es...</p>
                </div>

                <!-- Section: Accueil -->
                <section id="accueil-section" class="content-section active">
                    <div class="section-header">
                        <h2>üè† Tableau de Bord Principal</h2>
                        <p class="section-description">Vue d'ensemble des indicateurs cl√©s du projet PROCASEF √† Boundou</p>
                    </div>

                    <!-- KPI Cards Grid -->
                    <div class="kpi-grid">
                        <div class="kpi-card">
                            <div class="kpi-header">
                                <h3>Total Parcelles</h3>
                                <span class="kpi-icon">üìç</span>
                            </div>
                            <div class="kpi-value" id="totalParcelles">31,302</div>
                            <div class="kpi-subtitle">Parcelles identifi√©es</div>
                        </div>

                        <div class="kpi-card">
                            <div class="kpi-header">
                                <h3>Parcelles NICAD</h3>
                                <span class="kpi-icon">‚úÖ</span>
                            </div>
                            <div class="kpi-value success" id="parcellesNicad">17,146</div>
                            <div class="kpi-subtitle" id="percentageNicad">54.8% avec NICAD</div>
                        </div>

                        <div class="kpi-card">
                            <div class="kpi-header">
                                <h3>Parcelles D√©lib√©r√©es</h3>
                                <span class="kpi-icon">üìã</span>
                            </div>
                            <div class="kpi-value" id="parcellesDeliberees">11,036</div>
                            <div class="kpi-subtitle" id="percentageDeliberees">35.3% d√©lib√©r√©es</div>
                        </div>

                        <div class="kpi-card">
                            <div class="kpi-header">
                                <h3>Superficie Totale</h3>
                                <span class="kpi-icon">üìê</span>
                            </div>
                            <div class="kpi-value" id="superficieTotale">67,934.12</div>
                            <div class="kpi-subtitle">m¬≤</div>
                        </div>

                        <div class="kpi-card">
                            <div class="kpi-header">
                                <h3>Taux R√©alisation</h3>
                                <span class="kpi-icon">üìä</span>
                            </div>
                            <div class="kpi-value warning" id="tauxRealisation">47.80%</div>
                            <div class="kpi-subtitle">33457 / 70000</div>
                        </div>

                        <div class="kpi-card">
                            <div class="kpi-header">
                                <h3>Communes Actives</h3>
                                <span class="kpi-icon">üó∫Ô∏è</span>
                            </div>
                            <div class="kpi-value" id="communesActives">13/17</div>
                            <div class="kpi-subtitle">Zones d'intervention</div>
                        </div>
                    </div>

                    <!-- Charts Overview -->
                    <div class="charts-overview">
                        <div class="chart-card">
                            <div class="chart-header">
                                <h3>Top Communes par Parcelles</h3>
                            </div>
                            <div class="chart-content">
                                <canvas id="topCommunesChart"></canvas>
                            </div>
                        </div>

                        <div class="chart-card">
                            <div class="chart-header">
                                <h3>Projections Mensuelles 2025</h3>
                            </div>
                            <div class="chart-content">
                                <canvas id="projectionsChart"></canvas>
                            </div>
                        </div>

                        <div class="chart-card">
                            <div class="chart-header">
                                <h3>R√©partition Genre Global</h3>
                            </div>
                            <div class="chart-content">
                                <canvas id="genreGlobalChart"></canvas>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- Section: Parcelles -->
                <section id="parcelles-section" class="content-section">
                    <div class="section-header">
                        <h2>üìä R√©partition des Parcelles</h2>
                        <div class="filter-panel">
                            <select id="communeFilter" class="form-control">
                                <option value="">Toutes les communes</option>
                            </select>
                            <select id="nicadFilter" class="form-control">
                                <option value="">Tous statuts NICAD</option>
                                <option value="Oui">Avec NICAD</option>
                                <option value="Non">Sans NICAD</option>
                            </select>
                            <select id="deliberationFilter" class="form-control">
                                <option value="">Tous statuts d√©lib√©ration</option>
                                <option value="Oui">D√©lib√©r√©es</option>
                                <option value="Non">Non d√©lib√©r√©es</option>
                            </select>
                        </div>
                    </div>

                    <!-- Charts Grid -->
                    <div class="charts-grid">
                        <div class="chart-card">
                            <div class="chart-header">
                                <h3>Distribution par R√©gion</h3>
                            </div>
                            <div class="chart-content">
                                <canvas id="regionChart"></canvas>
                            </div>
                        </div>

                        <div class="chart-card">
                            <div class="chart-header">
                                <h3>Progression NICAD par Commune</h3>
                            </div>
                            <div class="chart-content">
                                <canvas id="nicadChart"></canvas>
                            </div>
                        </div>
                    </div>

                    <!-- Map Container -->
                    <div class="chart-card large">
                        <div class="chart-header">
                            <h3>Carte Interactive des Communes</h3>
                        </div>
                        <div class="chart-content">
                            <div id="mapContainer" style="height: 300px; width: 100%;"></div>
                        </div>
                    </div>

                    <!-- Data Table -->
                    <div class="table-container">
                        <div class="table-header">
                            <h3>Donn√©es d√©taill√©es par commune</h3>
                            <button class="btn btn--primary" id="exportParcellesBtn">
                                <span>üì•</span> Export CSV
                            </button>
                        </div>
                        <div class="table-responsive">
                            <table class="data-table" id="parcellesTable">
                                <thead>
                                    <tr>
                                        <th>R√©gion</th>
                                        <th>Commune</th>
                                        <th>Total Parcelles</th>
                                        <th>NICAD</th>
                                        <th>% NICAD</th>
                                        <th>D√©lib√©r√©es</th>
                                        <th>% D√©lib√©r√©es</th>
                                        <th>Superficie (ha)</th>
                                    </tr>
                                </thead>
                                <tbody id="parcellesTableBody">
                                    <!-- Data populated by JavaScript -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                </section>

                <!-- Section: √âtat d'avancement -->
                <section id="etat-avancement-section" class="content-section">
                    <div class="section-header">
                        <h2>üìà √âtat des Op√©rations</h2>
                        <div class="filter-panel">
                            <select id="regionFilterEtat" class="form-control">
                                <option value="">Toutes les r√©gions</option>
                            </select>
                            <select id="etatFilterEtat" class="form-control">
                                <option value="">Tous les √©tats</option>
                            </select>
                            <select id="csigFilterEtat" class="form-control">
                                <option value="">Tous les CSIG</option>
                            </select>
                            <select id="communeFilterEtat" class="form-control">
                                <option value="">Toutes les communes</option>
                            </select>
                        </div>
                    </div>
                
                    <!-- Progress Overview -->
                    <div class="progress-overview">
                        <div class="progress-card">
                            <h3>Progression Globale</h3>
                            <div class="progress-bar-container">
                                <div class="progress-bar">
                                    <div class="progress-fill" id="globalProgressFill" style="width: 67.4%;"></div>
                                </div>
                                <div class="progress-text" id="globalProgressText">67.4%</div>
                            </div>
                        </div>
                    </div>
                
                    <!-- Charts -->
                    <div class="charts-grid">
                        <div class="chart-card">
                            <div class="chart-header">
                                <h3>√âtat par Commune</h3>
                            </div>
                            <div class="chart-content">
                                <canvas id="etatCommuneBarChart"></canvas>
                            </div>
                        </div>
                        <div class="chart-card">
                            <div class="chart-header">
                                <h3>R√©partition des √âtats</h3>
                            </div>
                            <div class="chart-content">
                                <canvas id="etatDonutChart"></canvas>
                            </div>
                        </div>
                        <div class="chart-card large">
                            <div class="chart-header">
                                <h3>Timeline par Commune</h3>
                            </div>
                            <div class="timeline-container" id="etatTimeline"></div>
                        </div>
                    </div>
                </section>

                <!-- Section: Projections 2025 -->
                <section id="projections-2025-section" class="content-section">
                    <div class="section-header">
                        <h2>üéØ Projections et Objectifs 2025</h2>
                    </div>

                    <!-- Metrics Row -->
                    <div class="metrics-row">
                        <div class="metric-card">
                            <h3>Objectif 2025</h3>
                            <div class="metric-value" id="objectif2025">70000</div>
                        </div>
                        <div class="metric-card">
                            <h3>R√©alis√©</h3>
                            <div class="metric-value success" id="realise2025">31 302</div>
                        </div>
                        <div class="metric-card">
                            <h3>Performance</h3>
                            <div class="metric-value warning" id="performance2025">44.72%</div>
                        </div>
                    </div>

                    <!-- Charts -->
                    <div class="charts-grid">
                        <div class="chart-card">
                            <div class="chart-header">
                                <h3>Objectifs vs R√©alisations</h3>
                            </div>
                            <div class="chart-content">
                                <canvas id="objectifsChart"></canvas>
                            </div>
                        </div>

                        <div class="chart-card">
                            <div class="chart-header">
                                <h3>Performance par P√©riode</h3>
                            </div>
                            <div class="performance-list" id="performanceList">
                                <!-- Performance items populated by JavaScript -->
                            </div>
                        </div>
                    </div>
                </section>

                <!-- Section: Genre -->
                <section id="genre-section" class="content-section">
                    <div class="section-header">
                        <h2>üë´üèø R√©partition par Genre</h2>
                    </div>

                    <!-- Genre KPIs -->
                    <div class="metrics-row">
                        <div class="metric-card">
                            <h3>Hommes</h3>
                            <div class="metric-value" id="hommesTotal">43,576</div>
                            <div class="kpi-subtitle" id="hommesPercentage">82.4%</div>
                        </div>
                        <div class="metric-card">
                            <h3>Femmes</h3>
                            <div class="metric-value" id="femmesTotal">9,332</div>
                            <div class="kpi-subtitle" id="femmesPercentage">17.6%</div>
                        </div>
                    </div>

                    <!-- Charts -->
                    <div class="charts-grid">
                        <div class="chart-card">
                            <div class="chart-header">
                                <h3>R√©partition Globale</h3>
                            </div>
                            <div class="chart-content">
                                <canvas id="genreGlobalDonut"></canvas>
                            </div>
                        </div>

                        <div class="chart-card">
                            <div class="chart-header">
                                <h3>√âvolution Trimestrielle</h3>
                            </div>
                            <div class="chart-content">
                                <canvas id="genreTrimestreChart"></canvas>
                            </div>
                        </div>

                        <div class="chart-card large">
                            <div class="chart-header">
                                <h3>R√©partition par Commune</h3>
                            </div>
                            <div class="chart-content">
                                <canvas id="genreCommuneChart"></canvas>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- Section: Rapport complet -->
                <section id="rapport-section" class="content-section">
                    <div class="section-header">
                        <h2>üë´üèø R√©partition par Genre</h2>
                        <p class="section-description">Analyse d√©taill√©e des donn√©es genre du projet PROCASEF Boundou</p>
                    </div>

                    <!-- KPIs Synth√®se Globale -->
                    <div id="rapportKpiGrid" class="kpi-grid">
                        <!-- KPIs populated by JavaScript -->
                    </div>

                    <!-- Charts Rapport -->
                    <div class="charts-grid">
                        <div class="chart-card">
                            <div class="chart-header">
                                <h3>D√©tail par Source</h3>
                            </div>
                            <div class="chart-content">
                                <canvas id="rapportSourceChart"></canvas>
                            </div>
                        </div>

                        <div class="chart-card large">
                            <div class="chart-header">
                                <h3>Analyse par Commune (Top 10)</h3>
                            </div>
                            <div class="chart-content">
                                <canvas id="rapportCommuneMixedChart"></canvas>
                            </div>
                        </div>

                        <div class="chart-card">
                            <div class="chart-header">
                                <h3>Analyse Temporelle</h3>
                            </div>
                            <div class="chart-content">
                                <canvas id="rapportTemporalChart"></canvas>
                            </div>
                        </div>

                        <div class="chart-card">
                            <div class="chart-header">
                                <h3>R√©partition R√©gionale</h3>
                            </div>
                            <div class="chart-content">
                                <canvas id="rapportRegionPolarChart"></canvas>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- Section: Post-traitement -->
                <section id="post-traitement-section" class="content-section">
                    <div class="section-header">
                        <h2>‚öôÔ∏è Analyses de Post-Traitement</h2>
                        <div class="filter-panel">
                            <select id="postCommuneFilter" class="form-control">
                                <option value="">Toutes les communes</option>
                            </select>
                            <select id="postGeomFilter" class="form-control">
                                <option value="">Toutes les g√©om√©tries</option>
                            </select>
                        </div>
                    </div>

                    <!-- Post-processing Stats -->
                    <div class="post-processing-stats">
                        <div class="stat-item">
                            <h3>Total Re√ßues</h3>
                            <div class="stat-number" id="totalRecues">8,420</div>
                        </div>
                        <div class="stat-item">
                            <h3>Post-trait√©es</h3>
                            <div class="stat-number success" id="postTraitees">7,890</div>
                        </div>
                        <div class="stat-item">
                            <h3>Taux Traitement</h3>
                            <div class="stat-number" id="tauxTraitement">93.7%</div>
                        </div>
                    </div>

                    <!-- Charts -->
                    <div class="charts-grid">
                        <div class="chart-card">
                            <div class="chart-header">
                                <h3>Comparaison URM vs Terrain</h3>
                            </div>
                            <div class="chart-content">
                                <canvas id="urmTerrainChart"></canvas>
                            </div>
                        </div>
                    </div>

                    <!-- Data Table -->
                    <div class="table-container">
                        <div class="table-header">
                            <h3>Donn√©es de Post-traitement</h3>
                            <button class="btn btn--primary" id="exportPostBtn">
                                <span>üì•</span> Export CSV
                            </button>
                        </div>
                        <div class="table-responsive">
                            <table class="data-table" id="postTraitementTable">
                                <thead>
                                    <tr>
                                        <th>Commune</th>
                                        <th>Re√ßues</th>
                                        <th>Trait√©es</th>
                                        <th>Individuelles</th>
                                        <th>Collectives</th>
                                        <th>Jointure OK</th>
                                        <th>Taux (%)</th>
                                    </tr>
                                </thead>
                                <tbody id="postTraitementTableBody">
                                    <!-- Data populated by JavaScript -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                </section>
            </div>
        </main>
    </div>

    <!-- JavaScript Files -->
    <script src="js/data-loader.js"></script>
    <script src="js/charts.js"></script>
    <script src="js/map.js"></script>
    <script src="js/app.js"></script>
</body>
</html>
